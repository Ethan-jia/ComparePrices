<!--statistics.wxml-->
<navigation-bar title="æ•°æ®ç»Ÿè®¡" back="{{false}}" color="black" background="#FFF"></navigation-bar>

<view class="container">
  <!-- æ—¶é—´æ®µé€‰æ‹© -->
  <view class="period-selector">
    <view 
      wx:for="{{periods}}" 
      wx:key="value"
      class="period-item {{selectedPeriod === item.value ? 'active' : ''}}"
      data-period="{{item.value}}"
      bindtap="onPeriodChange"
    >
      {{item.label}}
    </view>
  </view>

  <!-- åŸºç¡€ç»Ÿè®¡å¡ç‰‡ -->
  <view class="stats-cards">
    <view class="stat-card" bindtap="showDevModal">
      <view class="stat-icon">ğŸ“¦</view>
      <view class="stat-value">{{totalProducts}}</view>
      <view class="stat-label">å•†å“æ€»æ•°</view>
    </view>
    <view class="stat-card" bindtap="showDevModal">
      <view class="stat-icon">ğŸ’°</view>
      <view class="stat-value">Â¥{{totalSpent}}</view>
      <view class="stat-label">æ¶ˆè´¹æ€»é¢</view>
    </view>
    <view class="stat-card" bindtap="showDevModal">
      <view class="stat-icon">ğŸ“Š</view>
      <view class="stat-value">Â¥{{averagePrice}}</view>
      <view class="stat-label">å¹³å‡ä»·æ ¼</view>
    </view>
  </view>

  <!-- åˆ†ç±»ç»Ÿè®¡ -->
  <!-- åˆ†ç±»ç»Ÿè®¡å·²ç§»é™¤ -->

  <!-- æœˆåº¦ç»Ÿè®¡ -->
  <view class="section-card" wx:if="{{monthlyStats.length > 0}}">
    <view class="section-title">æœˆåº¦æ¶ˆè´¹</view>
    <view class="monthly-stats">
      <view 
        wx:for="{{monthlyStats}}" 
        wx:key="month"
        class="monthly-stat-item"
      >
        <view class="month-label">{{item.month}}</view>
        <view class="month-bar">
          <view 
            class="month-bar-fill" 
            style="width: {{item.barWidth}}%"
          ></view>
        </view>
        <view class="month-amount">Â¥{{item.totalSpent}}</view>
      </view>
    </view>
  </view>

  <!-- æœ€è¿‘å•†å“ -->
  <view class="section-card" wx:if="{{recentProducts.length > 0}}">
    <view class="section-title">æœ€è¿‘æ·»åŠ </view>
    <view class="recent-products">
      <view 
        wx:for="{{recentProducts}}" 
        wx:key="id"
        class="recent-product-item"
        data-id="{{item.id}}"
        bindtap="goToProductDetail"
      >
        <view class="product-info">
          <view class="product-name">{{item.name}}</view>
          <view class="product-meta">{{item.date}} Â· {{item.location}}</view>
        </view>
        <view class="product-price">Â¥{{item.currentPrice}}</view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:if="{{totalProducts === 0}}" class="empty-state">
    <view class="empty-icon">ğŸ“Š</view>
    <view class="empty-text">æš‚æ— ç»Ÿè®¡æ•°æ®</view>
    <view class="empty-hint">æ·»åŠ å•†å“åå³å¯æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯</view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <!-- <view class="action-buttons"> -->
  <!--   <button class="action-btn btn-export" bindtap="exportData">å¯¼å‡ºæ•°æ®</button> -->
  <!--   <button class="action-btn btn-clear" bindtap="clearData">æ¸…ç©ºæ•°æ®</button> -->
  <!-- </view> -->

  <!-- åˆ†äº«å’Œè¯»å–æ•°æ®æŒ‰é’® -->
  <view class="action-buttons">
    <button class="action-btn btn-read" bindtap="readData">è¯»å–æ•°æ®</button>
    <button class="action-btn btn-share" bindtap="shareData">åˆ†äº«æ•°æ®</button>
  </view>
</view>
