<!--index.wxml-->
<navigation-bar title="æ¯”ä»·åŠ©æ‰‹" back="{{false}}" color="black" background="#FFF"></navigation-bar>

<view class="container">
  <!-- æœç´¢æ  -->
  <view class="search-section">
    <view class="search-box">
      <input 
        class="search-input" 
        placeholder="æœç´¢å•†å“ï¼Œå¦‚ï¼šç‰›å¥¶" 
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
      />
      <view class="search-icon">ğŸ”</view>
      <view wx:if="{{searchKeyword}}" class="clear-btn" bindtap="clearSearch">âœ•</view>
    </view>
    <view class="filter-btn" bindtap="toggleFilter">
      <text>ç­›é€‰</text>
      <text class="filter-icon">â–¼</text>
    </view>
  </view>

  <!-- ç­›é€‰é¢æ¿ -->
  <view class="filter-panel" wx:if="{{showFilter}}">
    <view class="category-list">
      <view 
        wx:for="{{categories}}" 
        wx:key="*this"
        class="category-item {{selectedCategory === item ? 'active' : ''}}"
        data-category="{{item}}"
        bindtap="selectCategory"
      >
        {{item}}
      </view>
    </view>
  </view>

  <!-- å•†å“åˆ—è¡¨ -->
  <view class="product-list">
    <view wx:if="{{filteredProducts.length === 0}}" class="empty-state">
      <view class="empty-icon">ğŸ“¦</view>
      <view class="empty-text">æš‚æ— å•†å“è®°å½•</view>
      <view class="empty-hint">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ·»åŠ ç¬¬ä¸€ä¸ªå•†å“</view>
    </view>
    
    <view 
      wx:for="{{filteredProducts}}" 
      wx:key="id"
      class="product-card-container"
    >
      <view 
        class="product-card {{item.swiping ? 'swiping' : ''}}"
        data-index="{{index}}"
        bindtouchstart="onTouchStart"
        bindtouchmove="onTouchMove"
        bindtouchend="onTouchEnd"
        bindtap="goToDetail"
      >
        <view class="product-info">
          <view class="product-name">{{item.name}}</view>
          <view class="product-meta">
            <text class="product-date">{{item.date}}</text>
            <text class="product-location">{{item.location}}</text>
          </view>
          <!-- <view class="product-category">{{item.category}}</view> -->
        </view>
        
        <view class="product-price">
          <view class="current-price">Â¥{{item.currentPrice}}</view>
          <view wx:if="{{item.originalPrice}}" class="original-price">Â¥{{item.originalPrice}}</view>
          <view wx:if="{{item.showDiscount}}" class="discount">
            çœÂ¥{{item.savedAmount}}
          </view>
        </view>
      </view>
      
      <view 
        class="delete-btn" 
        data-index="{{index}}"
        catchtap="deleteProduct"
      >
        åˆ é™¤
      </view>
    </view>
  </view>

  <!-- æ‚¬æµ®æ·»åŠ æŒ‰é’® -->
  <view class="fab" bindtap="goToAdd">
    <text class="fab-icon">+</text>
  </view>


</view>
